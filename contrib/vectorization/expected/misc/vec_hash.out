-- create function

CREATE FUNCTION gp_vec_hash_chk(data_string text, data_type text, is_vec boolean) RETURNS SETOF RECORD AS '$libdir/gp_vec_hash_chk', 'vec_hash_chk' LANGUAGE C STRICT EXECUTE ON MASTER;
CREATE


-- single

-- uint64
-- SELECT gp_vec_hash_chk('100','uint64',true);
-- SELECT gp_vec_hash_chk('100','uint64',false);
-- SELECT gp_vec_hash_chk('101','uint64',true);
-- SELECT gp_vec_hash_chk('101','uint64',false);
-- SELECT gp_vec_hash_chk('-10','uint64',true);
-- SELECT gp_vec_hash_chk('-10','uint64',false);

-- int64
SELECT gp_vec_hash_chk('100','int64',true);
 gp_vec_hash_chk
----------------------------
 (100,int64,0x0672fdd5,0,0)
(1 row)
SELECT gp_vec_hash_chk('100','int64',false);
 gp_vec_hash_chk
----------------------------
 (100,int64,0x0672fdd5,0,0)
(1 row)
SELECT gp_vec_hash_chk('101','int64',true);
 gp_vec_hash_chk
----------------------------
 (101,int64,0xfaede83a,3,1)
(1 row)
SELECT gp_vec_hash_chk('101','int64',false);
 gp_vec_hash_chk
----------------------------
 (101,int64,0xfaede83a,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10','int64',true);
 gp_vec_hash_chk
----------------------------
 (-10,int64,0x70afe8a5,1,1)
(1 row)
SELECT gp_vec_hash_chk('-10','int64',false);
 gp_vec_hash_chk
----------------------------
 (-10,int64,0x70afe8a5,1,1)
(1 row)

-- uint32
-- SELECT gp_vec_hash_chk('100','uint32',true);
-- SELECT gp_vec_hash_chk('100','uint32',false);
-- SELECT gp_vec_hash_chk('101','uint32',true);
-- SELECT gp_vec_hash_chk('101','uint32',false);
-- SELECT gp_vec_hash_chk('-10','uint32',true);
-- SELECT gp_vec_hash_chk('-10','uint32',false);

-- int32
SELECT gp_vec_hash_chk('100','int32',true);
 gp_vec_hash_chk
----------------------------
 (100,int32,0x0672fdd5,0,0)
(1 row)
SELECT gp_vec_hash_chk('100','int32',false);
 gp_vec_hash_chk
----------------------------
 (100,int32,0x0672fdd5,0,0)
(1 row)
SELECT gp_vec_hash_chk('101','int32',true);
 gp_vec_hash_chk
----------------------------
 (101,int32,0xfaede83a,3,1)
(1 row)
SELECT gp_vec_hash_chk('101','int32',false);
 gp_vec_hash_chk
----------------------------
 (101,int32,0xfaede83a,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10','int32',true);
 gp_vec_hash_chk
----------------------------
 (-10,int32,0x70afe8a5,1,1)
(1 row)
SELECT gp_vec_hash_chk('-10','int32',false);
 gp_vec_hash_chk
----------------------------
 (-10,int32,0x70afe8a5,1,1)
(1 row)

-- uint16
-- SELECT gp_vec_hash_chk('100','uint16',true);
-- SELECT gp_vec_hash_chk('100','uint16',false);
-- SELECT gp_vec_hash_chk('101','uint16',true);
-- SELECT gp_vec_hash_chk('101','uint16',false);
-- SELECT gp_vec_hash_chk('-10','uint16',true);
-- SELECT gp_vec_hash_chk('-10','uint16',false);

-- int16
SELECT gp_vec_hash_chk('100','int16',true);
 gp_vec_hash_chk
----------------------------
 (100,int16,0x0672fdd5,0,0)
(1 row)
SELECT gp_vec_hash_chk('100','int16',false);
 gp_vec_hash_chk
----------------------------
 (100,int16,0x0672fdd5,0,0)
(1 row)
SELECT gp_vec_hash_chk('101','int16',true);
 gp_vec_hash_chk
----------------------------
 (101,int16,0xfaede83a,3,1)
(1 row)
SELECT gp_vec_hash_chk('101','int16',false);
 gp_vec_hash_chk
----------------------------
 (101,int16,0xfaede83a,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10','int16',true);
 gp_vec_hash_chk
----------------------------
 (-10,int16,0x70afe8a5,1,1)
(1 row)
SELECT gp_vec_hash_chk('-10','int16',false);
 gp_vec_hash_chk
----------------------------
 (-10,int16,0x70afe8a5,1,1)
(1 row)

-- uint8
-- SELECT gp_vec_hash_chk('100','uint8',true);
-- SELECT gp_vec_hash_chk('100','uint8',false);
-- SELECT gp_vec_hash_chk('101','uint8',true);
-- SELECT gp_vec_hash_chk('101','uint8',false);
-- SELECT gp_vec_hash_chk('-10','uint8',true);
-- SELECT gp_vec_hash_chk('-10','uint8',false);

-- int8
SELECT gp_vec_hash_chk('100','int8',true);
 gp_vec_hash_chk
---------------------------
 (100,int8,0x0672fdd5,0,0)
(1 row)
SELECT gp_vec_hash_chk('100','int8',false);
 gp_vec_hash_chk
---------------------------
 (100,int8,0x0672fdd5,0,0)
(1 row)
SELECT gp_vec_hash_chk('101','int8',true);
 gp_vec_hash_chk
---------------------------
 (101,int8,0xfaede83a,3,1)
(1 row)
SELECT gp_vec_hash_chk('101','int8',false);
 gp_vec_hash_chk
---------------------------
 (101,int8,0xfaede83a,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10','int8',true);
 gp_vec_hash_chk
---------------------------
 (-10,int8,0x70afe8a5,1,1)
(1 row)
SELECT gp_vec_hash_chk('-10','int8',false);
 gp_vec_hash_chk
---------------------------
 (-10,int8,0x70afe8a5,1,1)
(1 row)

-- oid
SELECT gp_vec_hash_chk('100','oid',true);
 gp_vec_hash_chk
--------------------------
 (100,oid,0x0672fdd5,0,0)
(1 row)
SELECT gp_vec_hash_chk('100','oid',false);
 gp_vec_hash_chk
--------------------------
 (100,oid,0x0672fdd5,0,0)
(1 row)
SELECT gp_vec_hash_chk('101','oid',true);
 gp_vec_hash_chk
--------------------------
 (101,oid,0xfaede83a,3,1)
(1 row)
SELECT gp_vec_hash_chk('101','oid',false);
 gp_vec_hash_chk
--------------------------
 (101,oid,0xfaede83a,3,1)
(1 row)

-- float
SELECT gp_vec_hash_chk('1.0','float',true);
 gp_vec_hash_chk
----------------------------
 (1.0,float,0x1670e33c,0,0)
(1 row)
SELECT gp_vec_hash_chk('1.0','float',false);
 gp_vec_hash_chk
----------------------------
 (1.0,float,0x1670e33c,0,0)
(1 row)
SELECT gp_vec_hash_chk('0.01','float',true);
 gp_vec_hash_chk
-----------------------------
 (0.01,float,0x1febfc96,0,0)
(1 row)
SELECT gp_vec_hash_chk('0.01','float',false);
 gp_vec_hash_chk
-----------------------------
 (0.01,float,0x1febfc96,0,0)
(1 row)
SELECT gp_vec_hash_chk('-0.01','float',true);
 gp_vec_hash_chk
------------------------------
 (-0.01,float,0xd0447930,3,1)
(1 row)
SELECT gp_vec_hash_chk('-0.01','float',false);
 gp_vec_hash_chk
------------------------------
 (-0.01,float,0xd0447930,3,1)
(1 row)

-- double
SELECT gp_vec_hash_chk('1.0001','double',true);
 gp_vec_hash_chk
--------------------------------
 (1.0001,double,0x516d03b5,1,1)
(1 row)
SELECT gp_vec_hash_chk('1.0001','double',false);
 gp_vec_hash_chk
--------------------------------
 (1.0001,double,0x516d03b5,1,1)
(1 row)
SELECT gp_vec_hash_chk('0.01','double',true);
 gp_vec_hash_chk
------------------------------
 (0.01,double,0xdbab56bd,3,1)
(1 row)
SELECT gp_vec_hash_chk('0.01','double',false);
 gp_vec_hash_chk
------------------------------
 (0.01,double,0xdbab56bd,3,1)
(1 row)
SELECT gp_vec_hash_chk('-0.01','double',true);
 gp_vec_hash_chk
-------------------------------
 (-0.01,double,0xb78d4af6,2,0)
(1 row)
SELECT gp_vec_hash_chk('-0.01','double',false);
 gp_vec_hash_chk
-------------------------------
 (-0.01,double,0xb78d4af6,2,0)
(1 row)

-- text
SELECT gp_vec_hash_chk('a','text',true);
 gp_vec_hash_chk
-------------------------
 (a,text,0x401370b1,1,1)
(1 row)
SELECT gp_vec_hash_chk('a','text',false);
 gp_vec_hash_chk
-------------------------
 (a,text,0x401370b1,1,1)
(1 row)
SELECT gp_vec_hash_chk('ab','text',true); SELECT gp_vec_hash_chk('ab','text',false);
 gp_vec_hash_chk
--------------------------
 (ab,text,0x666effbd,1,1)
(1 row)
SELECT gp_vec_hash_chk('abc','text',true); SELECT gp_vec_hash_chk('abc','text',false);
 gp_vec_hash_chk
---------------------------
 (abc,text,0xd12feb97,3,1)
(1 row)
SELECT gp_vec_hash_chk('abcd','text',true); SELECT gp_vec_hash_chk('abcd','text',false);
 gp_vec_hash_chk
----------------------------
 (abcd,text,0xe885082c,3,1)
(1 row)
SELECT gp_vec_hash_chk('abcde','text',true); SELECT gp_vec_hash_chk('abcde','text',false);
 gp_vec_hash_chk
-----------------------------
 (abcde,text,0xe56fc644,3,1)
(1 row)
SELECT gp_vec_hash_chk('abcdef','text',true); SELECT gp_vec_hash_chk('abcdef','text',false);
 gp_vec_hash_chk
------------------------------
 (abcdef,text,0x97d7dfc0,2,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefg','text',true); SELECT gp_vec_hash_chk('abcdefg','text',false);
 gp_vec_hash_chk
-------------------------------
 (abcdefg,text,0x1de65ece,0,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefgh','text',true); SELECT gp_vec_hash_chk('abcdefgh','text',false);
 gp_vec_hash_chk
--------------------------------
 (abcdefgh,text,0x8b1e9c33,2,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefghi','text',true); SELECT gp_vec_hash_chk('abcdefghi','text',false);
 gp_vec_hash_chk
---------------------------------
 (abcdefghi,text,0xfa822f5f,3,1)
(1 row)
SELECT gp_vec_hash_chk('abcdefghij','text',true); SELECT gp_vec_hash_chk('abcdefghij','text',false);
 gp_vec_hash_chk
----------------------------------
 (abcdefghij,text,0x741ce98c,1,1)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijk','text',true); SELECT gp_vec_hash_chk('abcdefghijk','text',false);
 gp_vec_hash_chk
-----------------------------------
 (abcdefghijk,text,0xa78ef3d3,2,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijkl','text',true); SELECT gp_vec_hash_chk('abcdefghijkl','text',false);
 gp_vec_hash_chk
------------------------------------
 (abcdefghijkl,text,0xa1763ad4,2,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijklm','text',true);
 gp_vec_hash_chk
-------------------------------------
 (abcdefghijklm,text,0x1830c6d0,0,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijklm','text',false);
 gp_vec_hash_chk
-------------------------------------
 (abcdefghijklm,text,0x1830c6d0,0,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijklsafasdfdsfed','text',true);
 gp_vec_hash_chk
------------------------------------------------
 (abcdefghijklsafasdfdsfed,text,0xac36e277,2,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijklsafasdfdsfed','text',false);
 gp_vec_hash_chk
------------------------------------------------
 (abcdefghijklsafasdfdsfed,text,0xac36e277,2,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss','text',true);
 gp_vec_hash_chk
-------------------------------------------------------------------------------------------------
 (abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,text,0x5d594d2a,1,1)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss','text',false);
 gp_vec_hash_chk
-------------------------------------------------------------------------------------------------
 (abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,text,0x5d594d2a,1,1)
(1 row)
SELECT gp_vec_hash_chk('a|bcdefghijklsaf|asdfdsfed','text',true);
 gp_vec_hash_chk
-----------------------------------------------------
 (a,text,"0x401370b1 0xe6e636f9 0xd7902815","1 3",1)
(1 row)
SELECT gp_vec_hash_chk('a','text',false);
 gp_vec_hash_chk
-------------------------
 (a,text,0x401370b1,1,1)
(1 row)
SELECT gp_vec_hash_chk('bcdefghijklsaf','text',false);
 gp_vec_hash_chk
--------------------------------------
 (bcdefghijklsaf,text,0xe6e636f9,3,1)
(1 row)
SELECT gp_vec_hash_chk('asdfdsfed','text',false);
 gp_vec_hash_chk
---------------------------------
 (asdfdsfed,text,0xd7902815,3,1)
(1 row)

-- null
SELECT gp_vec_hash_chk('100','null',true);
 gp_vec_hash_chk
---------------------------
 (100,null,0x00000000,0,0)
(1 row)
SELECT gp_vec_hash_chk('100','null',false);
 gp_vec_hash_chk
---------------------------
 (100,null,0x00000000,0,0)
(1 row)


-- more than one

-- int64 int64
SELECT gp_vec_hash_chk('100,101','int64,int64',true);
 gp_vec_hash_chk
--------------------------------------
 (100,int64,101,int64,0xf6081390,3,1)
(1 row)
SELECT gp_vec_hash_chk('100,101','int64,int64',false);
 gp_vec_hash_chk
--------------------------------------
 (100,int64,101,int64,0xf6081390,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,int64',true);
 gp_vec_hash_chk
--------------------------------------
 (101,int64,102,int64,0xed47dc85,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,int64',false);
 gp_vec_hash_chk
--------------------------------------
 (101,int64,102,int64,0xed47dc85,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,int64',true);
 gp_vec_hash_chk
--------------------------------------
 (-10,int64,-11,int64,0xb4e0765b,2,0)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,int64',false);
 gp_vec_hash_chk
--------------------------------------
 (-10,int64,-11,int64,0xb4e0765b,2,0)
(1 row)


-- int64 int32
SELECT gp_vec_hash_chk('100,101','int64,int32',true);
 gp_vec_hash_chk
--------------------------------------
 (100,int64,101,int32,0xf6081390,3,1)
(1 row)
SELECT gp_vec_hash_chk('100,101','int64,int32',false);
 gp_vec_hash_chk
--------------------------------------
 (100,int64,101,int32,0xf6081390,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,int32',true);
 gp_vec_hash_chk
--------------------------------------
 (101,int64,102,int32,0xed47dc85,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,int32',false);
 gp_vec_hash_chk
--------------------------------------
 (101,int64,102,int32,0xed47dc85,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,int32',true);
 gp_vec_hash_chk
--------------------------------------
 (-10,int64,-11,int32,0xb4e0765b,2,0)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,int32',false);
 gp_vec_hash_chk
--------------------------------------
 (-10,int64,-11,int32,0xb4e0765b,2,0)
(1 row)


-- int64 int16
SELECT gp_vec_hash_chk('100,101','int64,int16',true);
 gp_vec_hash_chk
--------------------------------------
 (100,int64,101,int16,0xf6081390,3,1)
(1 row)
SELECT gp_vec_hash_chk('100,101','int64,int16',false);
 gp_vec_hash_chk
--------------------------------------
 (100,int64,101,int16,0xf6081390,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,int16',true);
 gp_vec_hash_chk
--------------------------------------
 (101,int64,102,int16,0xed47dc85,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,int16',false);
 gp_vec_hash_chk
--------------------------------------
 (101,int64,102,int16,0xed47dc85,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,int16',true);
 gp_vec_hash_chk
--------------------------------------
 (-10,int64,-11,int16,0xb4e0765b,2,0)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,int16',false);
 gp_vec_hash_chk
--------------------------------------
 (-10,int64,-11,int16,0xb4e0765b,2,0)
(1 row)

-- int64 int8
SELECT gp_vec_hash_chk('100,101','int64,int8',true);
 gp_vec_hash_chk
-------------------------------------
 (100,int64,101,int8,0xf6081390,3,1)
(1 row)
SELECT gp_vec_hash_chk('100,101','int64,int8',false);
 gp_vec_hash_chk
-------------------------------------
 (100,int64,101,int8,0xf6081390,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,int8',true);
 gp_vec_hash_chk
-------------------------------------
 (101,int64,102,int8,0xed47dc85,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,int8',false);
 gp_vec_hash_chk
-------------------------------------
 (101,int64,102,int8,0xed47dc85,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,int8',true);
 gp_vec_hash_chk
-------------------------------------
 (-10,int64,-11,int8,0xb4e0765b,2,0)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,int8',false);
 gp_vec_hash_chk
-------------------------------------
 (-10,int64,-11,int8,0xb4e0765b,2,0)
(1 row)


-- int64 oid
SELECT gp_vec_hash_chk('100,101','int64,oid',true);
 gp_vec_hash_chk
------------------------------------
 (100,int64,101,oid,0xf6081390,3,1)
(1 row)
SELECT gp_vec_hash_chk('100,101','int64,oid',false);
 gp_vec_hash_chk
------------------------------------
 (100,int64,101,oid,0xf6081390,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,oid',true);
 gp_vec_hash_chk
------------------------------------
 (101,int64,102,oid,0xed47dc85,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,oid',false);
 gp_vec_hash_chk
------------------------------------
 (101,int64,102,oid,0xed47dc85,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,oid',true);
 gp_vec_hash_chk
------------------------------------
 (-10,int64,-11,oid,0xb4e0765b,2,0)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,oid',false);
 gp_vec_hash_chk
------------------------------------
 (-10,int64,-11,oid,0xb4e0765b,2,0)
(1 row)

-- int64 float
SELECT gp_vec_hash_chk('100,101.1','int64,float',true);
 gp_vec_hash_chk
----------------------------------------
 (100,int64,101.1,float,0x8832a5e8,2,0)
(1 row)
SELECT gp_vec_hash_chk('100,101.1','int64,float',false);
 gp_vec_hash_chk
----------------------------------------
 (100,int64,101.1,float,0x8832a5e8,2,0)
(1 row)
SELECT gp_vec_hash_chk('101,102.1','int64,float',true);
 gp_vec_hash_chk
----------------------------------------
 (101,int64,102.1,float,0x9245e4b2,2,0)
(1 row)
SELECT gp_vec_hash_chk('101,102.1','int64,float',false);
 gp_vec_hash_chk
----------------------------------------
 (101,int64,102.1,float,0x9245e4b2,2,0)
(1 row)
SELECT gp_vec_hash_chk('-10,-11.0','int64,float',true);
 gp_vec_hash_chk
----------------------------------------
 (-10,int64,-11.0,float,0xb1039c22,2,0)
(1 row)
SELECT gp_vec_hash_chk('-10,-11.0','int64,float',false);
 gp_vec_hash_chk
----------------------------------------
 (-10,int64,-11.0,float,0xb1039c22,2,0)
(1 row)

-- int64 float
SELECT gp_vec_hash_chk('100,101.1','int64,double',true);
 gp_vec_hash_chk
-----------------------------------------
 (100,int64,101.1,double,0x6b5d094e,1,1)
(1 row)
SELECT gp_vec_hash_chk('100,101.1','int64,double',false);
 gp_vec_hash_chk
-----------------------------------------
 (100,int64,101.1,double,0x6b5d094e,1,1)
(1 row)
SELECT gp_vec_hash_chk('101,102.1','int64,double',true);
 gp_vec_hash_chk
-----------------------------------------
 (101,int64,102.1,double,0xc0b62f91,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102.1','int64,double',false);
 gp_vec_hash_chk
-----------------------------------------
 (101,int64,102.1,double,0xc0b62f91,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10,-11.0','int64,double',true);
 gp_vec_hash_chk
-----------------------------------------
 (-10,int64,-11.0,double,0xb1039c22,2,0)
(1 row)
SELECT gp_vec_hash_chk('-10,-11.0','int64,double',false);
 gp_vec_hash_chk
-----------------------------------------
 (-10,int64,-11.0,double,0xb1039c22,2,0)
(1 row)

-- int64 null
SELECT gp_vec_hash_chk('100,101','int64,null',true);
 gp_vec_hash_chk
-------------------------------------
 (100,int64,101,null,0x0ce5fbaa,0,0)
(1 row)
SELECT gp_vec_hash_chk('100,101','int64,null',false);
 gp_vec_hash_chk
-------------------------------------
 (100,int64,101,null,0x0ce5fbaa,0,0)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,null',true);
 gp_vec_hash_chk
-------------------------------------
 (101,int64,102,null,0xf5dbd075,3,1)
(1 row)
SELECT gp_vec_hash_chk('101,102','int64,null',false);
 gp_vec_hash_chk
-------------------------------------
 (101,int64,102,null,0xf5dbd075,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,null',true);
 gp_vec_hash_chk
-------------------------------------
 (-10,int64,-11,null,0xe15fd14a,3,1)
(1 row)
SELECT gp_vec_hash_chk('-10,-11','int64,null',false);
 gp_vec_hash_chk
-------------------------------------
 (-10,int64,-11,null,0xe15fd14a,3,1)
(1 row)


-- mixed
SELECT gp_vec_hash_chk('100,101,102,103,104','int64,int32,int16,int8,oid',true);
 gp_vec_hash_chk
-----------------------------------------------------------------
 (100,int64,101,int32,102,int16,103,int8,104,oid,0x95a35186,2,0)
(1 row)
SELECT gp_vec_hash_chk('100,101,102,103,104','int64,int32,int16,int8,oid',false);
 gp_vec_hash_chk
-----------------------------------------------------------------
 (100,int64,101,int32,102,int16,103,int8,104,oid,0x95a35186,2,0)
(1 row)
SELECT gp_vec_hash_chk('-100,-101,-102,-103,104','int64,int32,int16,int8,oid',true);
 gp_vec_hash_chk
---------------------------------------------------------------------
 (-100,int64,-101,int32,-102,int16,-103,int8,104,oid,0x980c0f0f,2,0)
(1 row)
SELECT gp_vec_hash_chk('-100,-101,-102,-103,104','int64,int32,int16,int8,oid',false);
 gp_vec_hash_chk
---------------------------------------------------------------------
 (-100,int64,-101,int32,-102,int16,-103,int8,104,oid,0x980c0f0f,2,0)
(1 row)

SELECT gp_vec_hash_chk('-10,-11,-12','null,int64,null',true);
 gp_vec_hash_chk
----------------------------------------------
 (-10,null,-11,int64,-12,null,0xab7f4e22,2,0)
(1 row)
SELECT gp_vec_hash_chk('-10,-11,-12','null,int64,null',false);
 gp_vec_hash_chk
----------------------------------------------
 (-10,null,-11,int64,-12,null,0xab7f4e22,2,0)
(1 row)

SELECT gp_vec_hash_chk('-10,-11,-12','null,null,null',true);
 gp_vec_hash_chk
---------------------------------------------
 (-10,null,-11,null,-12,null,0x00000000,0,0)
(1 row)
SELECT gp_vec_hash_chk('-10,-11,-12','null,null,null',false);
 gp_vec_hash_chk
---------------------------------------------
 (-10,null,-11,null,-12,null,0x00000000,0,0)
(1 row)

SELECT gp_vec_hash_chk('-10,-11,-12','null,null,int64',true);
 gp_vec_hash_chk
----------------------------------------------
 (-10,null,-11,null,-12,int64,0x9e5eec97,2,0)
(1 row)
SELECT gp_vec_hash_chk('-10,-11,-12','null,null,int64',false);
 gp_vec_hash_chk
----------------------------------------------
 (-10,null,-11,null,-12,int64,0x9e5eec97,2,0)
(1 row)

SELECT gp_vec_hash_chk('abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,1.109','text,double',true);
 gp_vec_hash_chk
--------------------------------------------------------------------------------------------------------------
 (abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,text,1.109,double,0x85eb55e3,2,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,1.109','text,double',false);
 gp_vec_hash_chk
--------------------------------------------------------------------------------------------------------------
 (abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,text,1.109,double,0x85eb55e3,2,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,1','text,null',true);
 gp_vec_hash_chk
--------------------------------------------------------------------------------------------------------
 (abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,text,1,null,0xbab29a54,2,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,1','text,null',false);
 gp_vec_hash_chk
--------------------------------------------------------------------------------------------------------
 (abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,text,1,null,0xbab29a54,2,0)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,10101','text,text',true);
 gp_vec_hash_chk
------------------------------------------------------------------------------------------------------------
 (abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,text,10101,text,0x552b9ff5,1,1)
(1 row)
SELECT gp_vec_hash_chk('abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,10101','text,text',false);
 gp_vec_hash_chk
------------------------------------------------------------------------------------------------------------
 (abcdefghijklsafasdfdsfedasdddffdsfdsdsfdsfdskasjdfdasjkfjdsafkdsffddassss,text,10101,text,0x552b9ff5,1,1)
(1 row)

-- drop function
DROP FUNCTION gp_vec_hash_chk(data_string text, data_type text, is_vec boolean);
DROP







