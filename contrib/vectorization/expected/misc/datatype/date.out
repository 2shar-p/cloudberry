
-- set vectorizaion
SET vector.enable_vectorization=on;
SET
-- create table
CREATE TABLE DATE_TBL (f1 date) WITH(APPENDONLY=true, ORIENTATION=column);
CREATE

INSERT INTO DATE_TBL VALUES ('1957-04-09');
INSERT 1
INSERT INTO DATE_TBL VALUES ('1957-06-13');
INSERT 1
INSERT INTO DATE_TBL VALUES ('1996-02-28');
INSERT 1
INSERT INTO DATE_TBL VALUES ('1996-02-29');
INSERT 1
INSERT INTO DATE_TBL VALUES ('1996-03-01');
INSERT 1
INSERT INTO DATE_TBL VALUES ('1996-03-02');
INSERT 1
INSERT INTO DATE_TBL VALUES ('1997-02-28');
INSERT 1
INSERT INTO DATE_TBL VALUES ('1997-02-29');
ERROR:  date/time field value out of range: "1997-02-29"
LINE 1: INSERT INTO DATE_TBL VALUES ('1997-02-29');
                                     ^
INSERT INTO DATE_TBL VALUES ('1997-03-01');
INSERT 1
INSERT INTO DATE_TBL VALUES ('1997-03-02');
INSERT 1
INSERT INTO DATE_TBL VALUES ('2000-04-01');
INSERT 1
INSERT INTO DATE_TBL VALUES ('2000-04-02');
INSERT 1
INSERT INTO DATE_TBL VALUES ('2000-04-03');
INSERT 1
INSERT INTO DATE_TBL VALUES ('2038-04-08');
INSERT 1
INSERT INTO DATE_TBL VALUES ('2039-04-09');
INSERT 1
INSERT INTO DATE_TBL VALUES ('2040-04-10');
INSERT 1

SELECT f1 AS "Fifteen" FROM DATE_TBL;
 Fifteen
------------
 04-09-1957
 03-02-1996
 02-28-1997
 04-02-2000
 04-10-2040
 06-13-1957
 02-28-1996
 02-29-1996
 03-01-1996
 03-01-1997
 03-02-1997
 04-01-2000
 04-03-2000
 04-08-2038
 04-09-2039
(15 rows)

SELECT f1 AS "Nine" FROM DATE_TBL WHERE f1 < '2000-01-01';
 Nine
------------
 04-09-1957
 03-02-1996
 02-28-1997
 06-13-1957
 02-28-1996
 02-29-1996
 03-01-1996
 03-01-1997
 03-02-1997
(9 rows)

SELECT f1 AS "Three" FROM DATE_TBL WHERE f1 BETWEEN '2000-01-01' AND '2001-01-01';
 Three
------------
 04-02-2000
 04-01-2000
 04-03-2000
(3 rows)

-- drop table

DROP TABLE DATE_TBL;
DROP
