set extra_float_digits = -1;;
set default_table_access_method=ao_column;
set vector.enable_vectorization = on;
ANALYZE;
explain (costs off) select
        o_orderpriority,
        count(*) as order_count
from
        orders
where
        o_orderdate >= date '1996-07-01'
        and o_orderdate < date '1996-07-01' + interval '3 month'
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority;
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Vec Gather Motion 3:1  (slice1; segments: 3)
   Merge Key: orders.o_orderpriority
   ->  Vec Finalize Vec GroupAggregate
         Group Key: orders.o_orderpriority
         ->  Vec Sort
               Sort Key: orders.o_orderpriority
               ->  Vec Redistribute Motion 3:3  (slice2; segments: 3)
                     Hash Key: orders.o_orderpriority
                     ->  Vec Streaming Vec Partial Vec HashAggregate
                           Group Key: orders.o_orderpriority
                           ->  Vec Hash Join
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Vec HashAggregate
                                       Group Key: lineitem.l_orderkey
                                       ->  Vec Seq Scan on lineitem
                                             Filter: (l_commitdate < l_receiptdate)
                                 ->  Vec Hash
                                       ->  Vec Seq Scan on orders
                                             Filter: ((o_orderdate >= '07-01-1996'::date) AND (o_orderdate < 'Tue Oct 01 00:00:00 1996'::timestamp without time zone))
 Optimizer: Pivotal Optimizer (GPORCA)
(20 rows)

select
        o_orderpriority,
        count(*) as order_count
from
        orders
where
        o_orderdate >= date '1996-07-01'
        and o_orderdate < date '1996-07-01' + interval '3 month'
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority;
 o_orderpriority | order_count 
-----------------+-------------
 1-URGENT        |         123
 2-HIGH          |         115
 3-MEDIUM        |         112
 4-NOT SPECIFIED |          92
 5-LOW           |         103
(5 rows)

