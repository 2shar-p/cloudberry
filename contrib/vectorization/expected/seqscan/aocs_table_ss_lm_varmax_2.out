-- test heap table sequence 
-- create table
CREATE TABLE IF NOT EXISTS t1 (a INT, b INT, c TEXT) WITH(APPENDONLY=true, ORIENTATION=column) DISTRIBUTED BY(a);
-- SET VECTORIZATION ON
SET vector.enable_vectorization=ON;
SET hashdata_use_late_materialize=ON;
ERROR:  unrecognized configuration parameter "hashdata_use_late_materialize"
-- SET MAX VERTORIZATION COUNT
SET vector.max_batch_size=128;
-- load data
SET vector.enable_vectorization=OFF;
INSERT INTO t1 SELECT i, i % 16, chr(65 + i % 26)  FROM GENERATE_SERIES(1, 2048) i;
-- start query
SET vector.enable_vectorization=ON;
SELECT * FROM t1 WHERE b = 1 ORDER BY a, c;
  a   | b | c 
------+---+---
    1 | 1 | B
   17 | 1 | R
   33 | 1 | H
   49 | 1 | X
   65 | 1 | N
   81 | 1 | D
   97 | 1 | T
  113 | 1 | J
  129 | 1 | Z
  145 | 1 | P
  161 | 1 | F
  177 | 1 | V
  193 | 1 | L
  209 | 1 | B
  225 | 1 | R
  241 | 1 | H
  257 | 1 | X
  273 | 1 | N
  289 | 1 | D
  305 | 1 | T
  321 | 1 | J
  337 | 1 | Z
  353 | 1 | P
  369 | 1 | F
  385 | 1 | V
  401 | 1 | L
  417 | 1 | B
  433 | 1 | R
  449 | 1 | H
  465 | 1 | X
  481 | 1 | N
  497 | 1 | D
  513 | 1 | T
  529 | 1 | J
  545 | 1 | Z
  561 | 1 | P
  577 | 1 | F
  593 | 1 | V
  609 | 1 | L
  625 | 1 | B
  641 | 1 | R
  657 | 1 | H
  673 | 1 | X
  689 | 1 | N
  705 | 1 | D
  721 | 1 | T
  737 | 1 | J
  753 | 1 | Z
  769 | 1 | P
  785 | 1 | F
  801 | 1 | V
  817 | 1 | L
  833 | 1 | B
  849 | 1 | R
  865 | 1 | H
  881 | 1 | X
  897 | 1 | N
  913 | 1 | D
  929 | 1 | T
  945 | 1 | J
  961 | 1 | Z
  977 | 1 | P
  993 | 1 | F
 1009 | 1 | V
 1025 | 1 | L
 1041 | 1 | B
 1057 | 1 | R
 1073 | 1 | H
 1089 | 1 | X
 1105 | 1 | N
 1121 | 1 | D
 1137 | 1 | T
 1153 | 1 | J
 1169 | 1 | Z
 1185 | 1 | P
 1201 | 1 | F
 1217 | 1 | V
 1233 | 1 | L
 1249 | 1 | B
 1265 | 1 | R
 1281 | 1 | H
 1297 | 1 | X
 1313 | 1 | N
 1329 | 1 | D
 1345 | 1 | T
 1361 | 1 | J
 1377 | 1 | Z
 1393 | 1 | P
 1409 | 1 | F
 1425 | 1 | V
 1441 | 1 | L
 1457 | 1 | B
 1473 | 1 | R
 1489 | 1 | H
 1505 | 1 | X
 1521 | 1 | N
 1537 | 1 | D
 1553 | 1 | T
 1569 | 1 | J
 1585 | 1 | Z
 1601 | 1 | P
 1617 | 1 | F
 1633 | 1 | V
 1649 | 1 | L
 1665 | 1 | B
 1681 | 1 | R
 1697 | 1 | H
 1713 | 1 | X
 1729 | 1 | N
 1745 | 1 | D
 1761 | 1 | T
 1777 | 1 | J
 1793 | 1 | Z
 1809 | 1 | P
 1825 | 1 | F
 1841 | 1 | V
 1857 | 1 | L
 1873 | 1 | B
 1889 | 1 | R
 1905 | 1 | H
 1921 | 1 | X
 1937 | 1 | N
 1953 | 1 | D
 1969 | 1 | T
 1985 | 1 | J
 2001 | 1 | Z
 2017 | 1 | P
 2033 | 1 | F
(128 rows)

SELECT * FROM t1 WHERE b < 0;
 a | b | c 
---+---+---
(0 rows)

SELECT * FROM t1 WHERE b > 15;
 a | b | c 
---+---+---
(0 rows)

SELECT * FROM t1 WHERE b = 15 ORDER BY a, c;
  a   | b  | c 
------+----+---
   15 | 15 | P
   31 | 15 | F
   47 | 15 | V
   63 | 15 | L
   79 | 15 | B
   95 | 15 | R
  111 | 15 | H
  127 | 15 | X
  143 | 15 | N
  159 | 15 | D
  175 | 15 | T
  191 | 15 | J
  207 | 15 | Z
  223 | 15 | P
  239 | 15 | F
  255 | 15 | V
  271 | 15 | L
  287 | 15 | B
  303 | 15 | R
  319 | 15 | H
  335 | 15 | X
  351 | 15 | N
  367 | 15 | D
  383 | 15 | T
  399 | 15 | J
  415 | 15 | Z
  431 | 15 | P
  447 | 15 | F
  463 | 15 | V
  479 | 15 | L
  495 | 15 | B
  511 | 15 | R
  527 | 15 | H
  543 | 15 | X
  559 | 15 | N
  575 | 15 | D
  591 | 15 | T
  607 | 15 | J
  623 | 15 | Z
  639 | 15 | P
  655 | 15 | F
  671 | 15 | V
  687 | 15 | L
  703 | 15 | B
  719 | 15 | R
  735 | 15 | H
  751 | 15 | X
  767 | 15 | N
  783 | 15 | D
  799 | 15 | T
  815 | 15 | J
  831 | 15 | Z
  847 | 15 | P
  863 | 15 | F
  879 | 15 | V
  895 | 15 | L
  911 | 15 | B
  927 | 15 | R
  943 | 15 | H
  959 | 15 | X
  975 | 15 | N
  991 | 15 | D
 1007 | 15 | T
 1023 | 15 | J
 1039 | 15 | Z
 1055 | 15 | P
 1071 | 15 | F
 1087 | 15 | V
 1103 | 15 | L
 1119 | 15 | B
 1135 | 15 | R
 1151 | 15 | H
 1167 | 15 | X
 1183 | 15 | N
 1199 | 15 | D
 1215 | 15 | T
 1231 | 15 | J
 1247 | 15 | Z
 1263 | 15 | P
 1279 | 15 | F
 1295 | 15 | V
 1311 | 15 | L
 1327 | 15 | B
 1343 | 15 | R
 1359 | 15 | H
 1375 | 15 | X
 1391 | 15 | N
 1407 | 15 | D
 1423 | 15 | T
 1439 | 15 | J
 1455 | 15 | Z
 1471 | 15 | P
 1487 | 15 | F
 1503 | 15 | V
 1519 | 15 | L
 1535 | 15 | B
 1551 | 15 | R
 1567 | 15 | H
 1583 | 15 | X
 1599 | 15 | N
 1615 | 15 | D
 1631 | 15 | T
 1647 | 15 | J
 1663 | 15 | Z
 1679 | 15 | P
 1695 | 15 | F
 1711 | 15 | V
 1727 | 15 | L
 1743 | 15 | B
 1759 | 15 | R
 1775 | 15 | H
 1791 | 15 | X
 1807 | 15 | N
 1823 | 15 | D
 1839 | 15 | T
 1855 | 15 | J
 1871 | 15 | Z
 1887 | 15 | P
 1903 | 15 | F
 1919 | 15 | V
 1935 | 15 | L
 1951 | 15 | B
 1967 | 15 | R
 1983 | 15 | H
 1999 | 15 | X
 2015 | 15 | N
 2031 | 15 | D
 2047 | 15 | T
(128 rows)

SELECT * FROM t1 WHERE a = 1000 ORDER BY b, c;
  a   | b | c 
------+---+---
 1000 | 8 | M
(1 row)

SELECT * FROM t1 WHERE a < 1000 and a > 990;
  a  | b  | c 
-----+----+---
 993 |  1 | F
 994 |  2 | G
 996 |  4 | I
 998 |  6 | K
 992 |  0 | E
 995 |  3 | H
 999 |  7 | L
 991 | 15 | D
 997 |  5 | J
(9 rows)

SELECT * FROM t1 WHERE a > 2000 and b = 10;
  a   | b  | c 
------+----+---
 2026 | 10 | Y
 2010 | 10 | I
 2042 | 10 | O
(3 rows)

-- reset max count
SET vector.max_batch_size=256;
SELECT * FROM t1 WHERE b = 1 ORDER BY a, c;
  a   | b | c 
------+---+---
    1 | 1 | B
   17 | 1 | R
   33 | 1 | H
   49 | 1 | X
   65 | 1 | N
   81 | 1 | D
   97 | 1 | T
  113 | 1 | J
  129 | 1 | Z
  145 | 1 | P
  161 | 1 | F
  177 | 1 | V
  193 | 1 | L
  209 | 1 | B
  225 | 1 | R
  241 | 1 | H
  257 | 1 | X
  273 | 1 | N
  289 | 1 | D
  305 | 1 | T
  321 | 1 | J
  337 | 1 | Z
  353 | 1 | P
  369 | 1 | F
  385 | 1 | V
  401 | 1 | L
  417 | 1 | B
  433 | 1 | R
  449 | 1 | H
  465 | 1 | X
  481 | 1 | N
  497 | 1 | D
  513 | 1 | T
  529 | 1 | J
  545 | 1 | Z
  561 | 1 | P
  577 | 1 | F
  593 | 1 | V
  609 | 1 | L
  625 | 1 | B
  641 | 1 | R
  657 | 1 | H
  673 | 1 | X
  689 | 1 | N
  705 | 1 | D
  721 | 1 | T
  737 | 1 | J
  753 | 1 | Z
  769 | 1 | P
  785 | 1 | F
  801 | 1 | V
  817 | 1 | L
  833 | 1 | B
  849 | 1 | R
  865 | 1 | H
  881 | 1 | X
  897 | 1 | N
  913 | 1 | D
  929 | 1 | T
  945 | 1 | J
  961 | 1 | Z
  977 | 1 | P
  993 | 1 | F
 1009 | 1 | V
 1025 | 1 | L
 1041 | 1 | B
 1057 | 1 | R
 1073 | 1 | H
 1089 | 1 | X
 1105 | 1 | N
 1121 | 1 | D
 1137 | 1 | T
 1153 | 1 | J
 1169 | 1 | Z
 1185 | 1 | P
 1201 | 1 | F
 1217 | 1 | V
 1233 | 1 | L
 1249 | 1 | B
 1265 | 1 | R
 1281 | 1 | H
 1297 | 1 | X
 1313 | 1 | N
 1329 | 1 | D
 1345 | 1 | T
 1361 | 1 | J
 1377 | 1 | Z
 1393 | 1 | P
 1409 | 1 | F
 1425 | 1 | V
 1441 | 1 | L
 1457 | 1 | B
 1473 | 1 | R
 1489 | 1 | H
 1505 | 1 | X
 1521 | 1 | N
 1537 | 1 | D
 1553 | 1 | T
 1569 | 1 | J
 1585 | 1 | Z
 1601 | 1 | P
 1617 | 1 | F
 1633 | 1 | V
 1649 | 1 | L
 1665 | 1 | B
 1681 | 1 | R
 1697 | 1 | H
 1713 | 1 | X
 1729 | 1 | N
 1745 | 1 | D
 1761 | 1 | T
 1777 | 1 | J
 1793 | 1 | Z
 1809 | 1 | P
 1825 | 1 | F
 1841 | 1 | V
 1857 | 1 | L
 1873 | 1 | B
 1889 | 1 | R
 1905 | 1 | H
 1921 | 1 | X
 1937 | 1 | N
 1953 | 1 | D
 1969 | 1 | T
 1985 | 1 | J
 2001 | 1 | Z
 2017 | 1 | P
 2033 | 1 | F
(128 rows)

SELECT * FROM t1 WHERE b < 0;
 a | b | c 
---+---+---
(0 rows)

SELECT * FROM t1 WHERE b > 15;
 a | b | c 
---+---+---
(0 rows)

SELECT * FROM t1 WHERE b = 15 ORDER BY a, c;
  a   | b  | c 
------+----+---
   15 | 15 | P
   31 | 15 | F
   47 | 15 | V
   63 | 15 | L
   79 | 15 | B
   95 | 15 | R
  111 | 15 | H
  127 | 15 | X
  143 | 15 | N
  159 | 15 | D
  175 | 15 | T
  191 | 15 | J
  207 | 15 | Z
  223 | 15 | P
  239 | 15 | F
  255 | 15 | V
  271 | 15 | L
  287 | 15 | B
  303 | 15 | R
  319 | 15 | H
  335 | 15 | X
  351 | 15 | N
  367 | 15 | D
  383 | 15 | T
  399 | 15 | J
  415 | 15 | Z
  431 | 15 | P
  447 | 15 | F
  463 | 15 | V
  479 | 15 | L
  495 | 15 | B
  511 | 15 | R
  527 | 15 | H
  543 | 15 | X
  559 | 15 | N
  575 | 15 | D
  591 | 15 | T
  607 | 15 | J
  623 | 15 | Z
  639 | 15 | P
  655 | 15 | F
  671 | 15 | V
  687 | 15 | L
  703 | 15 | B
  719 | 15 | R
  735 | 15 | H
  751 | 15 | X
  767 | 15 | N
  783 | 15 | D
  799 | 15 | T
  815 | 15 | J
  831 | 15 | Z
  847 | 15 | P
  863 | 15 | F
  879 | 15 | V
  895 | 15 | L
  911 | 15 | B
  927 | 15 | R
  943 | 15 | H
  959 | 15 | X
  975 | 15 | N
  991 | 15 | D
 1007 | 15 | T
 1023 | 15 | J
 1039 | 15 | Z
 1055 | 15 | P
 1071 | 15 | F
 1087 | 15 | V
 1103 | 15 | L
 1119 | 15 | B
 1135 | 15 | R
 1151 | 15 | H
 1167 | 15 | X
 1183 | 15 | N
 1199 | 15 | D
 1215 | 15 | T
 1231 | 15 | J
 1247 | 15 | Z
 1263 | 15 | P
 1279 | 15 | F
 1295 | 15 | V
 1311 | 15 | L
 1327 | 15 | B
 1343 | 15 | R
 1359 | 15 | H
 1375 | 15 | X
 1391 | 15 | N
 1407 | 15 | D
 1423 | 15 | T
 1439 | 15 | J
 1455 | 15 | Z
 1471 | 15 | P
 1487 | 15 | F
 1503 | 15 | V
 1519 | 15 | L
 1535 | 15 | B
 1551 | 15 | R
 1567 | 15 | H
 1583 | 15 | X
 1599 | 15 | N
 1615 | 15 | D
 1631 | 15 | T
 1647 | 15 | J
 1663 | 15 | Z
 1679 | 15 | P
 1695 | 15 | F
 1711 | 15 | V
 1727 | 15 | L
 1743 | 15 | B
 1759 | 15 | R
 1775 | 15 | H
 1791 | 15 | X
 1807 | 15 | N
 1823 | 15 | D
 1839 | 15 | T
 1855 | 15 | J
 1871 | 15 | Z
 1887 | 15 | P
 1903 | 15 | F
 1919 | 15 | V
 1935 | 15 | L
 1951 | 15 | B
 1967 | 15 | R
 1983 | 15 | H
 1999 | 15 | X
 2015 | 15 | N
 2031 | 15 | D
 2047 | 15 | T
(128 rows)

SELECT * FROM t1 WHERE a = 1000 ORDER BY b, c;
  a   | b | c 
------+---+---
 1000 | 8 | M
(1 row)

SELECT * FROM t1 WHERE a < 1000 and a > 990;
  a  | b  | c 
-----+----+---
 992 |  0 | E
 995 |  3 | H
 999 |  7 | L
 993 |  1 | F
 994 |  2 | G
 996 |  4 | I
 998 |  6 | K
 991 | 15 | D
 997 |  5 | J
(9 rows)

SELECT * FROM t1 WHERE a > 2000 and b = 10;
  a   | b  | c 
------+----+---
 2010 | 10 | I
 2042 | 10 | O
 2026 | 10 | Y
(3 rows)

SET vector.max_batch_size=64;
SELECT * FROM t1 WHERE b = 1 ORDER BY a, c;
  a   | b | c 
------+---+---
    1 | 1 | B
   17 | 1 | R
   33 | 1 | H
   49 | 1 | X
   65 | 1 | N
   81 | 1 | D
   97 | 1 | T
  113 | 1 | J
  129 | 1 | Z
  145 | 1 | P
  161 | 1 | F
  177 | 1 | V
  193 | 1 | L
  209 | 1 | B
  225 | 1 | R
  241 | 1 | H
  257 | 1 | X
  273 | 1 | N
  289 | 1 | D
  305 | 1 | T
  321 | 1 | J
  337 | 1 | Z
  353 | 1 | P
  369 | 1 | F
  385 | 1 | V
  401 | 1 | L
  417 | 1 | B
  433 | 1 | R
  449 | 1 | H
  465 | 1 | X
  481 | 1 | N
  497 | 1 | D
  513 | 1 | T
  529 | 1 | J
  545 | 1 | Z
  561 | 1 | P
  577 | 1 | F
  593 | 1 | V
  609 | 1 | L
  625 | 1 | B
  641 | 1 | R
  657 | 1 | H
  673 | 1 | X
  689 | 1 | N
  705 | 1 | D
  721 | 1 | T
  737 | 1 | J
  753 | 1 | Z
  769 | 1 | P
  785 | 1 | F
  801 | 1 | V
  817 | 1 | L
  833 | 1 | B
  849 | 1 | R
  865 | 1 | H
  881 | 1 | X
  897 | 1 | N
  913 | 1 | D
  929 | 1 | T
  945 | 1 | J
  961 | 1 | Z
  977 | 1 | P
  993 | 1 | F
 1009 | 1 | V
 1025 | 1 | L
 1041 | 1 | B
 1057 | 1 | R
 1073 | 1 | H
 1089 | 1 | X
 1105 | 1 | N
 1121 | 1 | D
 1137 | 1 | T
 1153 | 1 | J
 1169 | 1 | Z
 1185 | 1 | P
 1201 | 1 | F
 1217 | 1 | V
 1233 | 1 | L
 1249 | 1 | B
 1265 | 1 | R
 1281 | 1 | H
 1297 | 1 | X
 1313 | 1 | N
 1329 | 1 | D
 1345 | 1 | T
 1361 | 1 | J
 1377 | 1 | Z
 1393 | 1 | P
 1409 | 1 | F
 1425 | 1 | V
 1441 | 1 | L
 1457 | 1 | B
 1473 | 1 | R
 1489 | 1 | H
 1505 | 1 | X
 1521 | 1 | N
 1537 | 1 | D
 1553 | 1 | T
 1569 | 1 | J
 1585 | 1 | Z
 1601 | 1 | P
 1617 | 1 | F
 1633 | 1 | V
 1649 | 1 | L
 1665 | 1 | B
 1681 | 1 | R
 1697 | 1 | H
 1713 | 1 | X
 1729 | 1 | N
 1745 | 1 | D
 1761 | 1 | T
 1777 | 1 | J
 1793 | 1 | Z
 1809 | 1 | P
 1825 | 1 | F
 1841 | 1 | V
 1857 | 1 | L
 1873 | 1 | B
 1889 | 1 | R
 1905 | 1 | H
 1921 | 1 | X
 1937 | 1 | N
 1953 | 1 | D
 1969 | 1 | T
 1985 | 1 | J
 2001 | 1 | Z
 2017 | 1 | P
 2033 | 1 | F
(128 rows)

SELECT * FROM t1 WHERE b < 0;
 a | b | c 
---+---+---
(0 rows)

SELECT * FROM t1 WHERE b > 15;
 a | b | c 
---+---+---
(0 rows)

SELECT * FROM t1 WHERE b = 15 ORDER BY a, c;
  a   | b  | c 
------+----+---
   15 | 15 | P
   31 | 15 | F
   47 | 15 | V
   63 | 15 | L
   79 | 15 | B
   95 | 15 | R
  111 | 15 | H
  127 | 15 | X
  143 | 15 | N
  159 | 15 | D
  175 | 15 | T
  191 | 15 | J
  207 | 15 | Z
  223 | 15 | P
  239 | 15 | F
  255 | 15 | V
  271 | 15 | L
  287 | 15 | B
  303 | 15 | R
  319 | 15 | H
  335 | 15 | X
  351 | 15 | N
  367 | 15 | D
  383 | 15 | T
  399 | 15 | J
  415 | 15 | Z
  431 | 15 | P
  447 | 15 | F
  463 | 15 | V
  479 | 15 | L
  495 | 15 | B
  511 | 15 | R
  527 | 15 | H
  543 | 15 | X
  559 | 15 | N
  575 | 15 | D
  591 | 15 | T
  607 | 15 | J
  623 | 15 | Z
  639 | 15 | P
  655 | 15 | F
  671 | 15 | V
  687 | 15 | L
  703 | 15 | B
  719 | 15 | R
  735 | 15 | H
  751 | 15 | X
  767 | 15 | N
  783 | 15 | D
  799 | 15 | T
  815 | 15 | J
  831 | 15 | Z
  847 | 15 | P
  863 | 15 | F
  879 | 15 | V
  895 | 15 | L
  911 | 15 | B
  927 | 15 | R
  943 | 15 | H
  959 | 15 | X
  975 | 15 | N
  991 | 15 | D
 1007 | 15 | T
 1023 | 15 | J
 1039 | 15 | Z
 1055 | 15 | P
 1071 | 15 | F
 1087 | 15 | V
 1103 | 15 | L
 1119 | 15 | B
 1135 | 15 | R
 1151 | 15 | H
 1167 | 15 | X
 1183 | 15 | N
 1199 | 15 | D
 1215 | 15 | T
 1231 | 15 | J
 1247 | 15 | Z
 1263 | 15 | P
 1279 | 15 | F
 1295 | 15 | V
 1311 | 15 | L
 1327 | 15 | B
 1343 | 15 | R
 1359 | 15 | H
 1375 | 15 | X
 1391 | 15 | N
 1407 | 15 | D
 1423 | 15 | T
 1439 | 15 | J
 1455 | 15 | Z
 1471 | 15 | P
 1487 | 15 | F
 1503 | 15 | V
 1519 | 15 | L
 1535 | 15 | B
 1551 | 15 | R
 1567 | 15 | H
 1583 | 15 | X
 1599 | 15 | N
 1615 | 15 | D
 1631 | 15 | T
 1647 | 15 | J
 1663 | 15 | Z
 1679 | 15 | P
 1695 | 15 | F
 1711 | 15 | V
 1727 | 15 | L
 1743 | 15 | B
 1759 | 15 | R
 1775 | 15 | H
 1791 | 15 | X
 1807 | 15 | N
 1823 | 15 | D
 1839 | 15 | T
 1855 | 15 | J
 1871 | 15 | Z
 1887 | 15 | P
 1903 | 15 | F
 1919 | 15 | V
 1935 | 15 | L
 1951 | 15 | B
 1967 | 15 | R
 1983 | 15 | H
 1999 | 15 | X
 2015 | 15 | N
 2031 | 15 | D
 2047 | 15 | T
(128 rows)

SELECT * FROM t1 WHERE a = 1000 ORDER BY b, c;
  a   | b | c 
------+---+---
 1000 | 8 | M
(1 row)

SELECT * FROM t1 WHERE a < 1000 and a > 990;
  a  | b  | c 
-----+----+---
 993 |  1 | F
 994 |  2 | G
 996 |  4 | I
 998 |  6 | K
 991 | 15 | D
 997 |  5 | J
 992 |  0 | E
 995 |  3 | H
 999 |  7 | L
(9 rows)

SELECT * FROM t1 WHERE a > 2000 and b = 10;
  a   | b  | c 
------+----+---
 2026 | 10 | Y
 2010 | 10 | I
 2042 | 10 | O
(3 rows)

-- drop table
DROP TABLE t1;
