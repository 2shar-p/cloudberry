-- test heap table sequence

-- create table

CREATE TABLE IF NOT EXISTS t1 (a INT, b BIGINT, c SMALLINT) DISTRIBUTED BY(a);
CREATE
CREATE TABLE IF NOT EXISTS t2 (a INT, b BIGINT, c SMALLINT) DISTRIBUTED RANDOMLY;
CREATE
CREATE TABLE IF NOT EXISTS t3 (a INT, b BIGINT, c SMALLINT) DISTRIBUTED REPLICATED;
CREATE

-- SET VECTORIZATION ON

SET vector.enable_vectorization=ON;
SET

-- empty data query

SELECT * FROM t1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t1;
 a
---
(0 rows)
SELECT b FROM t1;
 b
---
(0 rows)
SELECT c FROM t1;
 c
---
(0 rows)
SELECT * FROM t2;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t2;
 a
---
(0 rows)
SELECT b FROM t2;
 b
---
(0 rows)
SELECT c FROM t2;
 c
---
(0 rows)
SELECT * FROM t3;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t3;
 a
---
(0 rows)
SELECT b FROM t3;
 b
---
(0 rows)
SELECT c FROM t3;
 c
---
(0 rows)

SELECT * FROM t1 WHERE a=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t1 WHERE a=1;
 a
---
(0 rows)
SELECT b FROM t1 WHERE a=1;
 b
---
(0 rows)
SELECT c FROM t1 WHERE a=1;
 c
---
(0 rows)
SELECT * FROM t2 WHERE a=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t2 WHERE a=1;
 a
---
(0 rows)
SELECT b FROM t2 WHERE a=1;
 b
---
(0 rows)
SELECT c FROM t2 WHERE a=1;
 c
---
(0 rows)
SELECT * FROM t3 WHERE a=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t3 WHERE a=1;
 a
---
(0 rows)
SELECT b FROM t3 WHERE a=1;
 b
---
(0 rows)
SELECT c FROM t3 WHERE a=1;
 c
---
(0 rows)

SELECT * FROM t1 WHERE a!=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t1 WHERE a!=1;
 a
---
(0 rows)
SELECT b FROM t1 WHERE a!=1;
 b
---
(0 rows)
SELECT c FROM t1 WHERE a!=1;
 c
---
(0 rows)
SELECT * FROM t2 WHERE a!=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t2 WHERE a!=1;
 a
---
(0 rows)
SELECT b FROM t2 WHERE a!=1;
 b
---
(0 rows)
SELECT c FROM t1 WHERE a!=1;
 c
---
(0 rows)
SELECT * FROM t3 WHERE a!=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t3 WHERE a!=1;
 a
---
(0 rows)
SELECT b FROM t3 WHERE a!=1;
 b
---
(0 rows)
SELECT c FROM t1 WHERE a!=1;
 c
---
(0 rows)

SELECT * FROM t1 WHERE a>1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t1 WHERE a>1;
 a
---
(0 rows)
SELECT b FROM t1 WHERE a>1;
 b
---
(0 rows)
SELECT c FROM t1 WHERE a>1;
 c
---
(0 rows)
SELECT * FROM t2 WHERE a>1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t2 WHERE a>1;
 a
---
(0 rows)
SELECT b FROM t2 WHERE a>1;
 b
---
(0 rows)
SELECT c FROM t2 WHERE a>1;
 c
---
(0 rows)
SELECT * FROM t3 WHERE a>1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t3 WHERE a>1;
 a
---
(0 rows)
SELECT b FROM t3 WHERE a>1;
 b
---
(0 rows)
SELECT c FROM t3 WHERE a>1;
 c
---
(0 rows)

SELECT * FROM t1 WHERE a<1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t1 WHERE a<1;
 a
---
(0 rows)
SELECT b FROM t1 WHERE a<1;
 b
---
(0 rows)
SELECT c FROM t1 WHERE a<1;
 c
---
(0 rows)
SELECT * FROM t2 WHERE a<1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t2 WHERE a<1;
 a
---
(0 rows)
SELECT b FROM t2 WHERE a<1;
 b
---
(0 rows)
SELECT c FROM t2 WHERE a<1;
 c
---
(0 rows)
SELECT * FROM t3 WHERE a<1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t3 WHERE a<1;
 a
---
(0 rows)
SELECT b FROM t3 WHERE a<1;
 b
---
(0 rows)
SELECT c FROM t3 WHERE a<1;
 c
---
(0 rows)

SELECT * FROM t1 WHERE a>=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t1 WHERE a>=1;
 a
---
(0 rows)
SELECT b FROM t1 WHERE a>=1;
 b
---
(0 rows)
SELECT c FROM t1 WHERE a>=1;
 c
---
(0 rows)
SELECT * FROM t2 WHERE a>=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t2 WHERE a>=1;
 a
---
(0 rows)
SELECT b FROM t2 WHERE a>=1;
 b
---
(0 rows)
SELECT c FROM t2 WHERE a>=1;
 c
---
(0 rows)
SELECT * FROM t3 WHERE a>=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t3 WHERE a>=1;
 a
---
(0 rows)
SELECT b FROM t3 WHERE a>=1;
 b
---
(0 rows)
SELECT c FROM t3 WHERE a>=1;
 c
---
(0 rows)

SELECT * FROM t1 WHERE a<=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t1 WHERE a<=1;
 a
---
(0 rows)
SELECT b FROM t1 WHERE a<=1;
 b
---
(0 rows)
SELECT c FROM t1 WHERE a<=1;
 c
---
(0 rows)
SELECT * FROM t2 WHERE a<=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t2 WHERE a<=1;
 a
---
(0 rows)
SELECT b FROM t2 WHERE a<=1;
 b
---
(0 rows)
SELECT c FROM t2 WHERE a<=1;
 c
---
(0 rows)
SELECT * FROM t3 WHERE a<=1;
 a | b | c
---+---+---
(0 rows)
SELECT a FROM t3 WHERE a<=1;
 a
---
(0 rows)
SELECT b FROM t3 WHERE a<=1;
 b
---
(0 rows)
SELECT c FROM t3 WHERE a<=1;
 c
---
(0 rows)

-- SELECT * FROM t1 WHERE a=1 AND a=2;
-- SELECT a FROM t1 WHERE a=1 AND a=2;
-- SELECT b FROM t1 WHERE a=1 AND a=2;
-- SELECT c FROM t1 WHERE a=1 AND a=2;
-- SELECT * FROM t2 WHERE a=1 AND a=2;
-- SELECT a FROM t2 WHERE a=1 AND a=2;
-- SELECT b FROM t2 WHERE a=1 AND a=2;
-- SELECT c FROM t1 WHERE a=1 AND a=2;
-- SELECT * FROM t3 WHERE a=1 AND a=2;
-- SELECT a FROM t3 WHERE a=1 AND a=2;
-- SELECT b FROM t3 WHERE a=1 AND a=2;
-- SELECT c FROM t3 WHERE a=1 AND a=2;


-- SELECT * FROM t1 WHERE a=1 OR a=2;
-- SELECT a FROM t1 WHERE a=1 OR a=2;
-- SELECT b FROM t1 WHERE a=1 OR a=2;
-- SELECT c FROM t1 WHERE a=1 OR a=2;
-- SELECT * FROM t2 WHERE a=1 OR a=2;
-- SELECT a FROM t2 WHERE a=1 OR a=2;
-- SELECT b FROM t2 WHERE a=1 OR a=2;
-- SELECT c FROM t2 WHERE a=1 OR a=2;
-- SELECT * FROM t3 WHERE a=1 OR a=2;
-- SELECT a FROM t3 WHERE a=1 OR a=2;
-- SELECT b FROM t3 WHERE a=1 OR a=2;
-- SELECT c FROM t3 WHERE a=1 OR a=2;


-- load data

INSERT INTO t1 VALUES (1, 2, 3), (2, 3, 4),(3, 4, 5);
INSERT 3
INSERT INTO t2 VALUES (1, 2, 3), (2, 3, 4),(3, 4, 5);
INSERT 3
INSERT INTO t3 VALUES (1, 2, 3), (2, 3, 4),(3, 4, 5);
INSERT 3

-- Query

SELECT * FROM t1;
 a | b | c
---+---+---
 2 | 3 | 4
 3 | 4 | 5
 1 | 2 | 3
(3 rows)
SELECT a FROM t1;
 a
---
 2
 3
 1
(3 rows)
SELECT b FROM t1;
 b
---
 3
 4
 2
(3 rows)
SELECT c FROM t1;
 c
---
 4
 5
 3
(3 rows)
SELECT * FROM t2;
 a | b | c
---+---+---
 1 | 2 | 3
 3 | 4 | 5
 2 | 3 | 4
(3 rows)
SELECT a FROM t2;
 a
---
 1
 3
 2
(3 rows)
SELECT b FROM t2;
 b
---
 2
 4
 3
(3 rows)
SELECT c FROM t2;
 c
---
 3
 5
 4
(3 rows)
SELECT * FROM t3;
 a | b | c
---+---+---
 1 | 2 | 3
 2 | 3 | 4
 3 | 4 | 5
(3 rows)
SELECT a FROM t3;
 a
---
 1
 2
 3
(3 rows)
SELECT b FROM t3;
 b
---
 2
 3
 4
(3 rows)
SELECT c FROM t3;
 c
---
 3
 4
 5
(3 rows)


-- SELECT * FROM t1 WHERE a=1;
-- SELECT a FROM t1 WHERE a=1;
-- SELECT b FROM t1 WHERE a=1;
-- SELECT c FROM t1 WHERE a=1;
-- SELECT * FROM t2 WHERE a=1;
-- SELECT a FROM t2 WHERE a=1;
-- SELECT b FROM t2 WHERE a=1;
-- SELECT c FROM t2 WHERE a=1;
-- SELECT * FROM t3 WHERE a=1;
-- SELECT a FROM t3 WHERE a=1;
-- SELECT b FROM t3 WHERE a=1;
-- SELECT c FROM t3 WHERE a=1;

-- SELECT * FROM t1 WHERE a!=1;
-- SELECT a FROM t1 WHERE a!=1;
-- SELECT b FROM t1 WHERE a!=1;
-- SELECT c FROM t1 WHERE a!=1;
-- SELECT * FROM t2 WHERE a!=1;
-- SELECT a FROM t2 WHERE a!=1;
-- SELECT b FROM t2 WHERE a!=1;
-- SELECT c FROM t1 WHERE a!=1;
-- SELECT * FROM t3 WHERE a!=1;
-- SELECT a FROM t3 WHERE a!=1;
-- SELECT b FROM t3 WHERE a!=1;
-- SELECT c FROM t1 WHERE a!=1;

-- SELECT * FROM t1 WHERE a>1;
-- SELECT a FROM t1 WHERE a>1;
-- SELECT b FROM t1 WHERE a>1;
-- SELECT c FROM t1 WHERE a>1;
-- SELECT * FROM t2 WHERE a>1;
-- SELECT a FROM t2 WHERE a>1;
-- SELECT b FROM t2 WHERE a>1;
-- SELECT c FROM t2 WHERE a>1;
-- SELECT * FROM t3 WHERE a>1;
-- SELECT a FROM t3 WHERE a>1;
-- SELECT b FROM t3 WHERE a>1;
-- SELECT c FROM t3 WHERE a>1;

-- SELECT * FROM t1 WHERE a<1;
-- SELECT a FROM t1 WHERE a<1;
-- SELECT b FROM t1 WHERE a<1;
-- SELECT c FROM t1 WHERE a<1;
-- SELECT * FROM t2 WHERE a<1;
-- SELECT a FROM t2 WHERE a<1;
-- SELECT b FROM t2 WHERE a<1;
-- SELECT c FROM t2 WHERE a<1;
-- SELECT * FROM t3 WHERE a<1;
-- SELECT a FROM t3 WHERE a<1;
-- SELECT b FROM t3 WHERE a<1;
-- SELECT c FROM t3 WHERE a<1;

-- SELECT * FROM t1 WHERE a>=1;
-- SELECT a FROM t1 WHERE a>=1;
-- SELECT b FROM t1 WHERE a>=1;
-- SELECT c FROM t1 WHERE a>=1;
-- SELECT * FROM t2 WHERE a>=1;
-- SELECT a FROM t2 WHERE a>=1;
-- SELECT b FROM t2 WHERE a>=1;
-- SELECT c FROM t2 WHERE a>=1;
-- SELECT * FROM t3 WHERE a>=1;
-- SELECT a FROM t3 WHERE a>=1;
-- SELECT b FROM t3 WHERE a>=1;
-- SELECT c FROM t3 WHERE a>=1;

-- SELECT * FROM t1 WHERE a<=1;
-- SELECT a FROM t1 WHERE a<=1;
-- SELECT b FROM t1 WHERE a<=1;
-- SELECT c FROM t1 WHERE a<=1;
-- SELECT * FROM t2 WHERE a<=1;
-- SELECT a FROM t2 WHERE a<=1;
-- SELECT b FROM t2 WHERE a<=1;
-- SELECT c FROM t2 WHERE a<=1;
-- SELECT * FROM t3 WHERE a<=1;
-- SELECT a FROM t3 WHERE a<=1;
-- SELECT b FROM t3 WHERE a<=1;
-- SELECT c FROM t3 WHERE a<=1;

-- SELECT * FROM t1 WHERE a=1 AND a=2;
-- SELECT a FROM t1 WHERE a=1 AND a=2;
-- SELECT b FROM t1 WHERE a=1 AND a=2;
-- SELECT * FROM t2 WHERE a=1 AND a=2;
-- SELECT a FROM t2 WHERE a=1 AND a=2;
-- SELECT b FROM t2 WHERE a=1 AND a=2;
-- SELECT * FROM t3 WHERE a=1 AND a=2;
-- SELECT a FROM t3 WHERE a=1 AND a=2;
-- SELECT b FROM t3 WHERE a=1 AND a=2;


-- SELECT * FROM t1 WHERE a=1 OR a=2;
-- SELECT a FROM t1 WHERE a=1 OR a=2;
-- SELECT b FROM t1 WHERE a=1 OR a=2;
-- SELECT * FROM t2 WHERE a=1 OR a=2;
-- SELECT a FROM t2 WHERE a=1 OR a=2;
-- SELECT b FROM t2 WHERE a=1 OR a=2;
-- SELECT * FROM t3 WHERE a=1 OR a=2;
-- SELECT a FROM t3 WHERE a=1 OR a=2;
-- SELECT b FROM t3 WHERE a=1 OR a=2;

-- drop table

DROP TABLE if EXISTS t1;
DROP
DROP TABLE if EXISTS t2;
DROP
DROP TABLE if EXISTS t3;
DROP


-- create table

CREATE TABLE IF NOT EXISTS t1 (a INT, b INT) DISTRIBUTED BY(a);
CREATE
CREATE TABLE IF NOT EXISTS t2 (a INT, b INT) DISTRIBUTED RANDOMLY;
CREATE
CREATE TABLE IF NOT EXISTS t3 (a INT, b INT) DISTRIBUTED REPLICATED;
CREATE

-- load data with NULL

INSERT INTO t1 VALUES (NULL, 2), (3, NULL),(NULL, NULL);
INSERT 3
INSERT INTO t2 VALUES (NULL, 2), (3, NULL),(NULL, NULL);
INSERT 3
INSERT INTO t3 VALUES (NULL, 2), (3, NULL),(NULL, NULL);
INSERT 3


-- query

-- SELECT * FROM t1;
-- SELECT a FROM t1;
-- SELECT b FROM t1;
-- SELECT * FROM t2;
-- SELECT a FROM t2;
-- SELECT b FROM t2;
-- SELECT * FROM t3;
-- SELECT a FROM t3;
-- SELECT b FROM t3;

-- SELECT * FROM t1 WHERE a=1;
-- SELECT a FROM t1 WHERE a=1;
-- SELECT b FROM t1 WHERE a=1;
-- SELECT * FROM t2 WHERE a=1;
-- SELECT a FROM t2 WHERE a=1;
-- SELECT b FROM t2 WHERE a=1;
-- SELECT * FROM t3 WHERE a=1;
-- SELECT a FROM t3 WHERE a=1;
-- SELECT b FROM t3 WHERE a=1;

-- SELECT * FROM t1 WHERE a>1;
-- SELECT a FROM t1 WHERE a>1;
-- SELECT b FROM t1 WHERE a>1;
-- SELECT * FROM t2 WHERE a>1;
-- SELECT a FROM t2 WHERE a>1;
-- SELECT b FROM t2 WHERE a>1;
-- SELECT * FROM t3 WHERE a>1;
-- SELECT a FROM t3 WHERE a>1;
-- SELECT b FROM t3 WHERE a>1;

-- SELECT * FROM t1 WHERE a<1;
-- SELECT a FROM t1 WHERE a<1;
-- SELECT b FROM t1 WHERE a<1;
-- SELECT * FROM t2 WHERE a<1;
-- SELECT a FROM t2 WHERE a<1;
-- SELECT b FROM t2 WHERE a<1;
-- SELECT * FROM t3 WHERE a<1;
-- SELECT a FROM t3 WHERE a<1;
-- SELECT b FROM t3 WHERE a<1;

-- SELECT * FROM t1 WHERE a>=1;
-- SELECT a FROM t1 WHERE a>=1;
-- SELECT b FROM t1 WHERE a>=1;
-- SELECT * FROM t2 WHERE a>=1;
-- SELECT a FROM t2 WHERE a>=1;
-- SELECT b FROM t2 WHERE a>=1;
-- SELECT * FROM t3 WHERE a>=1;
-- SELECT a FROM t3 WHERE a>=1;
-- SELECT b FROM t3 WHERE a>=1;

-- SELECT * FROM t1 WHERE a<=1;
-- SELECT a FROM t1 WHERE a<=1;
-- SELECT b FROM t1 WHERE a<=1;
-- SELECT * FROM t2 WHERE a<=1;
-- SELECT a FROM t2 WHERE a<=1;
-- SELECT b FROM t2 WHERE a<=1;
-- SELECT * FROM t3 WHERE a<=1;
-- SELECT a FROM t3 WHERE a<=1;
-- SELECT b FROM t3 WHERE a<=1;

-- SELECT * FROM t1 WHERE a=1 AND a=2;
-- SELECT a FROM t1 WHERE a=1 AND a=2;
-- SELECT b FROM t1 WHERE a=1 AND a=2;
-- SELECT * FROM t2 WHERE a=1 AND a=2;
-- SELECT a FROM t2 WHERE a=1 AND a=2;
-- SELECT b FROM t2 WHERE a=1 AND a=2;
-- SELECT * FROM t3 WHERE a=1 AND a=2;
-- SELECT a FROM t3 WHERE a=1 AND a=2;
-- SELECT b FROM t3 WHERE a=1 AND a=2;

-- SELECT * FROM t1 WHERE a=1 OR a=2;
-- SELECT a FROM t1 WHERE a=1 OR a=2;
-- SELECT b FROM t1 WHERE a=1 OR a=2;
-- SELECT * FROM t2 WHERE a=1 OR a=2;
-- SELECT a FROM t2 WHERE a=1 OR a=2;
-- SELECT b FROM t2 WHERE a=1 OR a=2;
-- SELECT * FROM t3 WHERE a=1 OR a=2;
-- SELECT a FROM t3 WHERE a=1 OR a=2;
-- SELECT b FROM t3 WHERE a=1 OR a=2;

SELECT * FROM t1 WHERE a IS NOT NULL;
 a | b
---+---
 3 |
(1 row)
SELECT a FROM t1 WHERE a IS NOT NULL;
 a
---
 3
(1 row)
SELECT b FROM t1 WHERE a IS NOT NULL;
 b
---

(1 row)
SELECT * FROM t2 WHERE a IS NOT NULL;
 a | b
---+---
 3 |
(1 row)
SELECT a FROM t2 WHERE a IS NOT NULL;
 a
---
 3
(1 row)
SELECT b FROM t2 WHERE a IS NOT NULL;
 b
---

(1 row)
SELECT * FROM t3 WHERE a IS NOT NULL;
 a | b
---+---
 3 |
(1 row)
SELECT a FROM t3 WHERE a IS NOT NULL;
 a
---
 3
(1 row)
SELECT b FROM t3 WHERE a IS NOT NULL;
 b
---

(1 row)

SELECT * FROM t1 WHERE a IS NULL;
 a | b
---+---
   | 2
   |
(2 rows)
SELECT a FROM t1 WHERE a IS NULL;
 a
---


(2 rows)
SELECT b FROM t1 WHERE a IS NULL;
 b
---
 2

(2 rows)
SELECT * FROM t2 WHERE a IS NULL;
 a | b
---+---
   |
   | 2
(2 rows)
SELECT a FROM t2 WHERE a IS NULL;
 a
---


(2 rows)
SELECT b FROM t2 WHERE a IS NULL;
 b
---
 2

(2 rows)
SELECT * FROM t3 WHERE a IS NULL;
 a | b
---+---
   | 2
   |
(2 rows)
SELECT a FROM t3 WHERE a IS NULL;
 a
---


(2 rows)
SELECT b FROM t3 WHERE a IS NULL;
 b
---
 2

(2 rows)


-- drop table

DROP TABLE if EXISTS t1;
DROP
DROP TABLE if EXISTS t2;
DROP
DROP TABLE if EXISTS t3;
DROP

