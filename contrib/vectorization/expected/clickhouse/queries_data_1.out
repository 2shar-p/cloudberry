-- set on vectorization
SET vector.enable_vectorization=on;
SET vector.max_batch_size=128;
-- query 1 - 10
SELECT count() FROM hits;
 count 
-------
   512
(1 row)

SELECT count() FROM hits WHERE AdvEngineID != 0::smallint;
 count 
-------
     1
(1 row)

SELECT sum(AdvEngineID), count() FROM hits;
 sum | count 
-----+-------
   3 |   512
(1 row)

SELECT sum(UserID) FROM hits;
          sum          
-----------------------
 732506250574480674434
(1 row)

SELECT count(distinct UserID) FROM hits;
 count 
-------
   132
(1 row)

SELECT count(distinct SearchPhrase) FROM hits;
 count 
-------
    43
(1 row)

SELECT min(EventDate), max(EventDate) FROM hits;
    min     |    max     
------------+------------
 03-22-2014 | 03-23-2014
(1 row)

SELECT AdvEngineID, count() FROM hits WHERE AdvEngineID != 0::smallint GROUP BY AdvEngineID ORDER BY count();
 advengineid | count 
-------------+-------
           3 |     1
(1 row)

SELECT RegionID, count(distinct UserID) AS u FROM hits GROUP BY RegionID ORDER BY regionid, u LIMIT 10;
 regionid | u 
----------+---
        1 | 2
        2 | 6
        3 | 6
        4 | 1
        7 | 1
       12 | 1
       14 | 1
       18 | 1
       21 | 1
       23 | 2
(10 rows)

SELECT RegionID, sum(AdvEngineID), count() AS c, count(distinct UserID) FROM hits GROUP BY RegionID ORDER BY regionid, c LIMIT 10;
 regionid | sum | c  | count 
----------+-----+----+-------
        1 |   0 | 10 |     2
        2 |   0 | 13 |     6
        3 |   0 | 12 |     6
        4 |   0 |  1 |     1
        7 |   0 |  1 |     1
       12 |   0 |  5 |     1
       14 |   0 |  2 |     1
       18 |   0 |  1 |     1
       21 |   0 |  9 |     1
       23 |   0 | 20 |     2
(10 rows)

